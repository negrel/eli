#!/usr/bin/env bash

SCRIPT_DIR=$(dirname $(readlink -f "${BASH_SOURCE[0]}"))

set -e -o pipefail
shopt -s inherit_errexit

source "$SCRIPT_DIR/lib/log.sh"
source "$SCRIPT_DIR/lib/traps.sh"
source "$SCRIPT_DIR/lib/run.sh"
source "$SCRIPT_DIR/lib/deps.sh"
source "$SCRIPT_DIR/lib/buildah.sh"
source "$SCRIPT_DIR/lib/install_utils.sh"
source "$SCRIPT_DIR/lib/options.sh"

trap exit_trap EXIT

if [ -n "$ELI_CMD_TRACE" ]; then
  set -x
fi

function eli_cmd {
  source "$SCRIPT_DIR/cmd/eli.sh"
  main $@
}

cmdname=$0

eli_cmd $@
